<!DOCTYPE html><html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>TrackerPro - Admin Dashboard</title> <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"> <style> :root{--primary-color:#4a6fff;--primary-light:#e5eaff;--primary-dark:#3a5ccc;--secondary-color:#ff7e42;--text-color:#333333;--text-light:#666666;--light-color:#f8f9fc;--gray-color:#dfe2e9;--success-color:#2ecc71;--warning-color:#f1c40f;--danger-color:#e74c3c;--white:#ffffff;--shadow-sm:0 2px 4px rgba(0,0,0,0.05);--shadow-md:0 4px 8px rgba(0,0,0,0.1);--border-radius-sm:4px;--border-radius-md:8px;--transition:all 0.3s ease;--header-height:70px;--sidebar-width:250px;--bg-card:#ffffff;--border:#e2e8f0;--text-muted:#64748b;--text-secondary:#475569;--text-primary:#1e293b;--bg-hover:#f1f5f9}*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Poppins',sans-serif;background-color:#f9fafb;color:var(--text-color);line-height:1.6;overflow-x:hidden}.header-bar{background-color:var(--white);height:var(--header-height);position:fixed;top:0;left:0;right:0;z-index:100;box-shadow:var(--shadow-sm);display:flex;align-items:center;padding:0 2rem 0 5rem;justify-content:space-between}.logo-container{display:flex;align-items:center;gap:0.75rem}.logo{height:38px;width:38px;object-fit:contain}.logo-text{font-size:1.4rem;font-weight:600;color:black;white-space:nowrap}.header-actions{display:flex;align-items:center;gap:1rem}.header-search{position:relative;width:300px}.header-search input{width:100%;padding:0.5rem 1rem 0.5rem 2.5rem;border-radius:50px;border:1px solid var(--gray-color);font-size:0.9rem;outline:none;transition:var(--transition)}.header-search input:focus{border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.header-search::before{content:'üîçÔ∏é';position:absolute;left:12px;top:50%;transform:translateY(-50%);font-size:1rem;color:var(--text-light)}.header-notifications{position:relative;cursor:pointer;width:40px;height:40px;display:flex;align-items:center;justify-content:center;background-color:var(--light-color);border-radius:50%;transition:var(--transition)}.header-notifications:hover{background-color:var(--primary-light)}.header-notifications::after{content:'8';position:absolute;top:-2px;right:-2px;background-color:var(--secondary-color);color:white;font-size:0.7rem;width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600}.user-profile{display:flex;align-items:center;gap:0.75rem;cursor:pointer}.user-avatar{width:40px;height:40px;background-color:var(--primary-light);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;color:var(--primary-dark);font-size:1.2rem}.user-details .user-name{font-weight:500;font-size:0.9rem;line-height:1.2}.user-details .user-role{font-size:0.8rem;color:var(--text-light)}.dashboard-container{display:flex;min-height:100vh;padding-top:var(--header-height)}.sidebar{width:var(--sidebar-width);background:var(--bg-card);border-right:1px solid var(--border);height:calc(100vh - var(--header-height));position:fixed;top:var(--header-height);left:0;overflow-y:auto;padding:1.5rem 0 0 0;z-index:90;transition:all 0.3s ease;display:flex;flex-direction:column}.sidebar.collapsed{transform:translateX(-230px)}.nav-section{margin-bottom:1rem;padding-bottom:1rem;flex:1}.nav-title{font-size:0.75rem;font-weight:600;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;padding:0 1.5rem;margin-bottom:0.5rem}.nav-item{display:flex;align-items:center;padding:0.75rem 1.5rem;color:var(--text-secondary);text-decoration:none;font-size:0.875rem;font-weight:500;transition:var(--transition);position:relative;cursor:pointer;border-left:3px solid transparent;margin:2px 0}.nav-item:hover{background:var(--bg-hover);color:var(--text-primary)}.nav-item.active{background:var(--primary-light);color:var(--primary-color);font-weight:600;border-left:3px solid var(--primary-color)}.nav-icon{width:20px;height:20px;margin-right:0.75rem;opacity:0.8}.nav-badge{margin-left:auto;font-size:0.75rem;padding:0.125rem 0.5rem;background:var(--danger-color);color:white;border-radius:10px;font-weight:600;min-width:1.25rem;text-align:center}.nav-item-text{width:100%}.sidebar-footer{margin-top:auto;padding:1rem 0 0 0;border-top:1px solid var(--border);background:var(--white)}.logout-nav-item{display:flex;align-items:center;padding:0.75rem 1.5rem;color:var(--danger-color);text-decoration:none;font-size:0.875rem;font-weight:500;transition:var(--transition);cursor:pointer;border-left:3px solid transparent;margin:2px 0}.logout-nav-item:hover{background:rgba(231,76,60,0.1);border-left:3px solid var(--danger-color)}.logout-nav-item .logout-icon-sidebar{font-size:1.1rem;margin-right:0.75rem}.main-content{flex:1;margin-left:var(--sidebar-width);padding:2rem;transition:margin-left 0.3s ease;padding-top:calc(var(--header-height) + 1rem)}.sidebar.collapsed ~ .main-content{margin-left:0}.page{display:none}.page.active-page{display:block}.page-title{margin-bottom:2rem;font-size:1.6rem;font-weight:600}.dashboard-stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:1.5rem;margin-bottom:2rem}.stat-card{background-color:var(--white);border-radius:var(--border-radius-md);box-shadow:var(--shadow-sm);padding:1.5rem;transition:var(--transition);position:relative;overflow:hidden}.stat-card:hover{box-shadow:var(--shadow-md);transform:translateY(-3px)}.stat-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%}.stat-card.primary::before{background-color:var(--primary-color)}.stat-card.secondary::before{background-color:var(--secondary-color)}.stat-card.success::before{background-color:var(--success-color)}.stat-card.warning::before{background-color:var(--warning-color)}.stat-card .stat-icon{position:absolute;top:1.5rem;right:1.5rem;font-size:2rem;opacity:0.1}.stat-card .stat-title{font-size:0.9rem;color:var(--text-light);margin-bottom:0.5rem;font-weight:500}.stat-card .stat-value{font-size:1.75rem;font-weight:600;margin-bottom:1rem}.stat-card .stat-description{font-size:0.85rem;color:var(--text-light);margin-top:auto}.content-area{background-color:var(--white);border-radius:var(--border-radius-md);box-shadow:var(--shadow-sm);padding:1.5rem;margin-bottom:2rem}.content-area h2{margin-bottom:1.5rem;font-size:1.2rem;font-weight:600;border-bottom:1px solid var(--gray-color);padding-bottom:0.75rem}.data-table{width:100%;border-collapse:collapse}.data-table th,.data-table td{padding:1rem;text-align:left;border-bottom:1px solid var(--gray-color);vertical-align:middle}.data-table th{font-weight:500;color:var(--text-light);font-size:0.9rem}.data-table tbody tr:hover{background-color:var(--light-color)}.badge{padding:0.4rem 0.85rem;border-radius:4px;font-size:0.75rem;font-weight:500;display:inline-block}.badge-success{background-color:rgba(46,204,113,0.15);color:#27ae60;border:1px solid rgba(46,204,113,0.3)}.badge-warning{background-color:rgba(241,196,15,0.15);color:#f39c12;border:1px solid rgba(241,196,15,0.3)}.badge-danger{background-color:rgba(231,76,60,0.15);color:#c0392b;border:1px solid rgba(231,76,60,0.3)}.badge-primary{background-color:rgba(74,111,255,0.15);color:#4a6fff;border:1px solid rgba(74,111,255,0.3)}.badge-info{background-color:rgba(52,152,219,0.15);color:#2980b9;border:1px solid rgba(52,152,219,0.3)}.badge-disabled{background-color:rgba(149,165,166,0.15);color:#7f8c8d;border:1px solid rgba(149,165,166,0.3)}.actions{display:flex;gap:0.5rem;flex-wrap:wrap}.btn{padding:0.5rem 1rem;border-radius:var(--border-radius-sm);font-size:0.875rem;font-weight:500;cursor:pointer;border:none;transition:var(--transition);display:inline-flex;align-items:center;justify-content:center;line-height:1}.btn-sm{padding:0.35rem 0.75rem;font-size:0.75rem}.btn-primary{background-color:var(--primary-color);color:white}.btn-primary:hover{background-color:var(--primary-dark)}.btn-success{background-color:var(--success-color);color:white}.btn-danger{background-color:var(--danger-color);color:white}.btn-secondary{background-color:var(--secondary-color);color:white}.btn-outline{background-color:var(--white);border:1px solid var(--gray-color);color:var(--text-color)}.btn-outline:hover{background-color:var(--light-color)}.btn-outline.active{background-color:var(--primary-color);color:white;border-color:var(--primary-color)}.table-actions{display:flex;justify-content:space-between;margin-bottom:1rem;align-items:center;flex-wrap:wrap;gap:1rem}.form-control{padding:0.5rem 1rem;border:1px solid var(--gray-color);border-radius:var(--border-radius-sm);font-size:0.875rem;outline:none;transition:var(--transition);width:100%}.form-control:focus{border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:1000;justify-content:center;align-items:center}.modal.active{display:flex}.modal-content{background-color:var(--white);border-radius:var(--border-radius-md);width:100%;padding:2rem;box-shadow:var(--shadow-md);position:relative;max-height:calc(100vh - 100px);overflow-y:auto}.modal-content.small{max-width:500px}.modal-content.medium{max-width:700px}.modal-content.large{max-width:900px}.modal-content.extra-large{max-width:1200px}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding-bottom:0.75rem;border-bottom:1px solid var(--gray-color)}.modal-header h3{margin:0;font-weight:600;font-size:1.2rem}.close-modal{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--text-light)}.modal-body{margin-bottom:1.5rem}.modal-footer{display:flex;justify-content:flex-end;gap:1rem;padding-top:1rem;border-top:1px solid var(--gray-color)}.form-group{margin-bottom:1.25rem}.form-group label{display:block;margin-bottom:0.5rem;font-weight:500;font-size:0.875rem}select.form-control{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23888' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 1rem center;background-size:1rem}textarea.form-control{min-height:100px;resize:vertical}.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem;margin-bottom:2rem}.pagination{display:flex;justify-content:center;align-items:center;gap:0.5rem;margin-top:2rem}.pagination button{padding:0.5rem 1rem;border:1px solid var(--gray-color);background:white;cursor:pointer;border-radius:var(--border-radius-sm)}.pagination button:hover{background:var(--light-color)}.pagination button.active{background:var(--primary-color);color:white;border-color:var(--primary-color)}.pagination button:disabled{opacity:0.5;cursor:not-allowed}.search-filter-bar{display:flex;gap:1rem;margin-bottom:2rem;flex-wrap:wrap;align-items:center}.search-filter-bar .form-control{min-width:200px}.alert{padding:1rem;border-radius:var(--border-radius-sm);margin-bottom:1rem;border:1px solid}.alert-success{background:rgba(46,204,113,0.1);border-color:var(--success-color);color:var(--success-color)}.alert-error{background:rgba(231,76,60,0.1);border-color:var(--danger-color);color:var(--danger-color)}.alert-info{background:var(--primary-light);border-color:var(--primary-color);color:var(--primary-color)}.menu-toggle{position:fixed;left:20px;top:15px;width:40px;height:40px;background:var(--white);border:none;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:5px;cursor:pointer;z-index:1001;box-shadow:0 2px 8px rgba(0,0,0,0.1);transition:all 0.3s ease}.menu-toggle span{width:20px;height:2px;background:#333;border-radius:2px;transition:none}.settings-tabs{display:flex;gap:1rem;margin-bottom:2rem;border-bottom:1px solid var(--border);flex-wrap:wrap}.settings-tab{padding:1rem 1.5rem;background:transparent;border:none;border-bottom:3px solid transparent;cursor:pointer;font-weight:500;font-size:0.95rem;color:var(--text-secondary);transition:all 0.2s ease}.settings-tab:hover{color:var(--primary-color)}.settings-tab.active{color:var(--primary-color);border-bottom-color:var(--primary-color)}.settings-content{display:none}.settings-content.active{display:block}.analytics-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-bottom:2rem}.checkbox-group{display:flex;align-items:center;gap:0.75rem;margin-bottom:1rem}.checkbox-group input[type="checkbox"]{width:18px;height:18px;cursor:pointer}.checkbox-group label{margin-bottom:0;cursor:pointer}.application-count{display:inline-flex;align-items:center;gap:0.5rem;padding:0.25rem 0.75rem;background:var(--primary-light);color:var(--primary-color);border-radius:12px;font-size:0.85rem;font-weight:600}.status-toggle{display:inline-flex;align-items:center;gap:0.5rem}.status-toggle input{width:40px;height:20px}.preview-container{background:var(--light-color);padding:2rem;border-radius:var(--border-radius-md);border:1px solid var(--border)}.preview-container h4{margin-bottom:1rem;color:var(--text-primary)}.preview-container .preview-field{margin-bottom:1rem}.preview-container .preview-label{font-weight:600;color:var(--text-secondary);font-size:0.85rem;margin-bottom:0.25rem}.preview-container .preview-value{color:var(--text-color);font-size:0.95rem}.info-card{background:var(--light-color);padding:1.5rem;border-radius:var(--border-radius-md);border-left:4px solid var(--primary-color);margin-bottom:1.5rem}.info-card h4{margin-bottom:0.5rem;color:var(--text-primary)}.info-card p{color:var(--text-secondary);font-size:0.9rem;line-height:1.6}@media (max-width:768px){.header-bar{padding:0 1rem 0 4.5rem}.logo-text{font-size:1.1rem}.sidebar{transform:translateX(-100%)}.sidebar.collapsed{transform:translateX(-100%)}.sidebar:not(.collapsed){transform:translateX(0)}.main-content{margin-left:0}.dashboard-stats{grid-template-columns:1fr}.table-actions{flex-direction:column;align-items:stretch}.search-filter-bar{flex-direction:column;align-items:stretch}.settings-tabs{overflow-x:auto}} </style> </head> <body> <header class="header-bar"> <button class="menu-toggle" id="menuToggle" onclick="toggleSidebar()"> <span></span> <span></span> <span></span> </button> <div class="logo-container"> <img src="LOGO.png" alt="TrackerPro Logo" class="logo" onerror="this.style.display='none'"> <h1 class="logo-text">TrackerPro</h1> </div> <div class="header-actions"> <div class="header-search"> <input type="text" placeholder="Search..." id="headerSearch"> </div> <div class="header-notifications" title="Notifications" id="notificationsBtn">üîî</div> <div class="user-profile" title="Admin Profile"> <div class="user-avatar">A</div> <div class="user-details"> <div class="user-name">Admin User</div> <div class="user-role">Administrator</div> </div> </div> </div> </header>
<div class="dashboard-container">
    <aside class="sidebar" id="sidebar">
        <div class="nav-section">
            <div class="nav-item active" data-page="dashboard">
                <span class="nav-item-text">Dashboard</span>
            </div>
            <div class="nav-item" data-page="registrations">
                <span class="nav-item-text">All Registrations</span>
            </div>
            <div class="nav-item" data-page="user-management">
                <span class="nav-item-text">User Management</span>
            </div>
            <div class="nav-item" data-page="internship-management">
                <span class="nav-item-text">Career Outcomes</span>
            </div>

            <div class="nav-item" data-page="complaints">
                <span class="nav-item-text">Manage Complaints</span>
            </div>
            <div class="nav-item" data-page="system-settings">
                <span class="nav-item-text">App Settings</span>
            </div>
        </div>
        <div class="sidebar-footer">
            <div class="logout-nav-item" onclick="logout()">
                <span class="logout-icon-sidebar">„Äê‚èª„Äë</span>
                <span>Logout</span>
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div id="dashboard" class="page active-page">
            <h1 class="page-title">Welcome to Admin Workspace</h1>

            <div class="dashboard-stats">
                <div class="stat-card primary">
                    <span class="stat-icon">üéì</span>
                    <div class="stat-title">Total Students</div>
                    <div class="stat-value" id="totalRegistrations">0</div>
                    <div class="stat-description">+12% from last month</div>
                </div>
                <div class="stat-card secondary">
                    <span class="stat-icon">üë®‚Äçüè´</span>
                    <div class="stat-title">Faculty & HR</div>
                    <div class="stat-value" id="totalUsers">0</div>
                    <div class="stat-description">Active users</div>
                </div>
                <div class="stat-card success">
                    <span class="stat-icon">üìö</span>
                    <div class="stat-title">Published Posts</div>
                    <div class="stat-value" id="totalPosts">0</div>
                    <div class="stat-description">Available posts</div>
                </div>
                <div class="stat-card warning">
                    <span class="stat-icon">‚≠ê</span>
                    <div class="stat-title">New Students</div>
                    <div class="stat-value" id="newUsers">0</div>
                    <div class="stat-description">This week</div>
                </div>
            </div>
        </div>

        <div id="registrations" class="page">
            <h1 class="page-title">All Registrations</h1>

            <div class="search-filter-bar">
                <input type="text" class="form-control" placeholder="Search students by name, email..." id="registrationSearch" oninput="filterRegistrations()">
                <button class="btn btn-danger" onclick="deleteSelectedRegistrations()" id="deleteSelectedBtn" style="display:none;">Delete Selected</button>
                <button class="btn btn-primary" onclick="exportRegistrations()">Export Data</button>
            </div>

            <div class="content-area">
                <div class="table-actions">
                    <div>
                        <button class="btn btn-outline" onclick="refreshRegistrations()">Refresh</button>
                    </div>
                    <div>
                        <span>Showing <span id="registrationShowingCount">0</span> of <span id="registrationTotalCount">0</span> entries</span>
                    </div>
                </div>

                <div style="overflow-x: auto;">
                    <table class="data-table" id="registrationsTable">
                        <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll" onchange="toggleSelectAll()"></th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Email</th>
                            <th>Gender</th>
                            <th>DOB</th>
                            <th>City</th>
                            <th>Mobile No</th>
                            <th>Role</th>
                            <th>Registered On</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div class="pagination" id="registrationPagination"></div>
            </div>
        </div>

        <div id="user-management" class="page">
            <h1 class="page-title">User Management</h1>

            <div class="content-area">
                <div class="table-actions">
                    <button class="btn btn-primary" onclick="openAddUserModal()">+ Add User</button>
                    <div>
                        <button class="btn btn-outline active" onclick="filterUsers('all')" id="filterAll">All</button>
                        <button class="btn btn-outline" onclick="filterUsers('faculty')" id="filterFaculty">Faculty</button>
                        <button class="btn btn-outline" onclick="filterUsers('hr')" id="filterHR">HR Staff</button>
                    </div>
                </div>

                <div style="overflow-x: auto;">
                    <table class="data-table" id="usersTable">
                        <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="internship-management" class="page">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h1 class="page-title" style="margin-bottom: 0;">Career Outcomes</h1>
                <button class="btn btn-primary" onclick="toggleInternshipForm()">
                    <span id="internshipFormToggleText">Create Post</span>
                </button>
            </div>

            <div class="content-area">
                <div class="table-actions">
                    <h2 style="margin: 0;">All Posts</h2>
                    <button class="btn btn-outline" onclick="loadInternshipsData()">üóò</button>
                </div>
                <div id="internshipsList"></div>
            </div>

            <div id="internshipFormSheet" class="modal" style="align-items: flex-start; padding-top: 2rem;">
                <div class="modal-content large" style="margin-top: 0; max-height: calc(100vh - 4rem);">
                    <div class="modal-header">
                        <h3 id="internshipModalTitle">Create New Post</h3>
                        <button class="close-modal" onclick="toggleInternshipForm()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="internshipForm" onsubmit="saveInternship(event)" class="form-grid">
                            <div class="form-group">
                                <label for="internshipCode">Internship ID *</label>
                                <input type="text" id="internshipCode" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="internshipTitle">Internship Title *</label>
                                <input type="text" id="internshipTitle" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="internshipDuration">Duration (Months) *</label>
                                <input type="number" id="internshipDuration" class="form-control" min="1" max="60" required>
                            </div>
                            <div class="form-group">
                                <label for="internshipWorkMode">Work Mode *</label>
                                <select id="internshipWorkMode" class="form-control" required>
                                    <option value="">Select Work Mode</option>
                                    <option value="Online">Online</option>
                                    <option value="Offline">Offline</option>
                                    <option value="Hybrid">Hybrid</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="internshipPrerequisites">Required Skills</label>
                                <input type="text" id="internshipPrerequisites" class="form-control">
                            </div>
                            <div class="form-group">
                                <label for="internshipStatus">Status *</label>
                                <select id="internshipStatus" class="form-control" required>
                                    <option value="Draft">Draft (Hidden from students)</option>
                                    <option value="Posted">Posted (Visible to students)</option>
                                </select>
                            </div>
                            <div class="form-group" style="grid-column: 1 / -1;">
                                <label for="internshipDescription">Post Description *</label>
                                <textarea id="internshipDescription" class="form-control" rows="4" required></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-outline" onclick="toggleInternshipForm()">Cancel</button>
                        <button type="button" class="btn btn-secondary" onclick="previewPost()">Preview</button>
                        <button type="submit" form="internshipForm" class="btn btn-primary">Save Post</button>
                    </div>
                </div>
            </div>

            <div id="previewModal" class="modal">
                <div class="modal-content large">
                    <div class="modal-header">
                        <h3>Post Preview</h3>
                        <button class="close-modal" onclick="closeModal('previewModal')">&times;</button>
                    </div>
                    <div class="modal-body" id="previewContent"></div>
                    <div class="modal-footer" id="previewModalFooter">
                        <button class="btn btn-outline" onclick="closeModal('previewModal')">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="complaints" class="page">
            <h1 class="page-title">Complaints Management</h1>

            <div class="info-card">
                <h4>Complaints System Overview</h4>
                <p>This section is designed to manage student complaints, feedback, and grievances. Features include complaint tracking, priority assignment, status management, and resolution workflows. The full complaint management system will be implemented in future updates with complete backend integration.</p>
            </div>

            <div class="analytics-grid">
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-title">Total Complaints</div>
                    <div class="stat-value">24</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üîì</div>
                    <div class="stat-title">Open</div>
                    <div class="stat-value">8</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-title">Resolved</div>
                    <div class="stat-value">16</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-title">High Priority</div>
                    <div class="stat-value">3</div>
                </div>
            </div>

            <div class="content-area">
                <h2>Sample Complaints Data</h2>
                <div class="table-actions">
                    <div>
                        <button class="btn btn-outline" disabled>Export Report</button>
                        <button class="btn btn-outline" disabled>Mark All Read</button>
                    </div>
                    <div>
                        <select class="form-control" disabled>
                            <option value="">All Status</option>
                            <option value="Open">Open</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Resolved">Resolved</option>
                        </select>
                        <select class="form-control" disabled>
                            <option value="">All Priority</option>
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>
                </div>

                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                        <tr>
                            <th>ID</th>
                            <th>Category</th>
                            <th>Priority</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Assigned To</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>#C001</td>
                            <td>Course Quality</td>
                            <td><span class="badge badge-danger">High</span></td>
                            <td>2024-01-15</td>
                            <td><span class="badge badge-warning">Open</span></td>
                            <td>Unassigned</td>
                            <td><div class="actions"><button class="btn btn-sm btn-outline" disabled>View</button><button class="btn btn-sm btn-primary" disabled>Assign</button><button class="btn btn-sm btn-success" disabled>Resolve</button></div></td>
                        </tr>
                        <tr>
                            <td>#C002</td>
                            <td>Faculty Behavior</td>
                            <td><span class="badge badge-warning">Medium</span></td>
                            <td>2024-01-14</td>
                            <td><span class="badge badge-success">Resolved</span></td>
                            <td>Admin User</td>
                            <td><div class="actions"><button class="btn btn-sm btn-outline" disabled>View</button></div></td>
                        </tr>
                        <tr>
                            <td>#C003</td>
                            <td>Technical Issue</td>
                            <td><span class="badge badge-primary">Low</span></td>
                            <td>2024-01-13</td>
                            <td><span class="badge badge-info">In Progress</span></td>
                            <td>Tech Team</td>
                            <td><div class="actions"><button class="btn btn-sm btn-outline" disabled>View</button><button class="btn btn-sm btn-success" disabled>Resolve</button></div></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="system-settings" class="page">
            <h1 class="page-title">System Settings</h1>

            <div class="info-card">
                <h4>System Configuration Center</h4>
                <p>This section provides comprehensive system configuration options including general settings, registration controls, notification preferences, email templates, backup management, and audit logs. Full functionality with backend integration will be implemented in future development phases.</p>
            </div>

            <div class="content-area">
                <div class="settings-tabs">
                    <button class="settings-tab active" onclick="showSettingsTab('general')">General Settings</button>
                    <button class="settings-tab" onclick="showSettingsTab('registration')">Registration</button>
                    <button class="settings-tab" onclick="showSettingsTab('notifications')">Notifications</button>
                    <button class="settings-tab" onclick="showSettingsTab('email')">Email Templates</button>
                    <button class="settings-tab" onclick="showSettingsTab('backup')">Backup & Restore</button>
                    <button class="settings-tab" onclick="showSettingsTab('audit')">Audit Logs</button>
                </div>

                <div id="generalSettings" class="settings-content active">
                    <h3>General System Configuration</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="systemName">System Name</label>
                            <input type="text" id="systemName" class="form-control" value="TrackerPro SPTS" disabled>
                        </div>
                        <div class="form-group">
                            <label for="supportEmail">Support Email</label>
                            <input type="email" id="supportEmail" class="form-control" value="support@trackerpro.com" disabled>
                        </div>
                        <div class="form-group">
                            <label for="organizationName">Organization Name</label>
                            <input type="text" id="organizationName" class="form-control" value="Educational Institute" disabled>
                        </div>
                        <div class="form-group">
                            <label for="maxAdminLogin">Max Admin Login Attempts</label>
                            <input type="number" id="maxAdminLogin" class="form-control" value="5" min="1" disabled>
                        </div>
                    </div>
                    <button class="btn btn-primary" disabled>Save Settings</button>
                </div>

                <div id="registrationSettings" class="settings-content">
                    <h3>Registration & Admission Settings</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="registrationStatus">Registration Control</label>
                            <select id="registrationStatus" class="form-control" disabled>
                                <option value="open" selected>Open for Applications</option>
                                <option value="closed">Closed - No New Applications</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="studentAgeReq">Student Age Requirement</label>
                            <input type="text" id="studentAgeReq" class="form-control" value="18-30 years" disabled>
                        </div>
                    </div>
                    <button class="btn btn-primary" disabled>Update Settings</button>
                </div>

                <div id="notificationSettings" class="settings-content">
                    <h3>Notification Preferences</h3>
                    <h4>Email Notifications</h4>
                    <div class="checkbox-group">
                        <input type="checkbox" id="newApplications" checked disabled>
                        <label for="newApplications">New Student Applications</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="batchUpdates" checked disabled>
                        <label for="batchUpdates">Batch Status Updates</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="securityAlerts" checked disabled>
                        <label for="securityAlerts">System Security Alerts</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="complaintNotifications" checked disabled>
                        <label for="complaintNotifications">New Complaint Submissions</label>
                    </div>
                    <button class="btn btn-primary" disabled>Save Preferences</button>
                </div>

                <div id="emailSettings" class="settings-content">
                    <h3>Email Templates Configuration</h3>
                    <div class="form-group">
                        <label for="welcomeEmail">Welcome Email Template</label>
                        <textarea id="welcomeEmail" class="form-control" rows="5" placeholder="Enter welcome email template..." disabled></textarea>
                    </div>
                    <div class="form-group">
                        <label for="approvalEmail">Application Approval Template</label>
                        <textarea id="approvalEmail" class="form-control" rows="5" placeholder="Enter approval email template..." disabled></textarea>
                    </div>
                    <div class="form-group">
                        <label for="rejectionEmail">Application Rejection Template</label>
                        <textarea id="rejectionEmail" class="form-control" rows="5" placeholder="Enter rejection email template..." disabled></textarea>
                    </div>
                    <button class="btn btn-primary" disabled>Save Templates</button>
                </div>

                <div id="backupSettings" class="settings-content">
                    <h3>Backup & Restore</h3>
                    <div class="alert alert-info">
                        Regular backups help protect your data. Create backups before major updates.
                    </div>
                    <div style="margin: 2rem 0;">
                        <button class="btn btn-primary" disabled>Create Backup Now</button>
                        <button class="btn btn-outline" disabled>Restore from Backup</button>
                    </div>
                    <h4>Backup History</h4>
                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>Backup Date</th>
                                <th>Size</th>
                                <th>Type</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>2024-01-15 10:30 AM</td>
                                <td>2.5 MB</td>
                                <td>Automatic</td>
                                <td><span class="badge badge-success">Complete</span></td>
                                <td><button class="btn btn-sm btn-outline" disabled>Restore</button></td>
                            </tr>
                            <tr>
                                <td>2024-01-10 08:15 AM</td>
                                <td>2.3 MB</td>
                                <td>Manual</td>
                                <td><span class="badge badge-success">Complete</span></td>
                                <td><button class="btn btn-sm btn-outline" disabled>Restore</button></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="auditSettings" class="settings-content">
                    <h3>Audit Logs & User Activity</h3>
                    <div class="form-group">
                        <label for="auditDateFilter">Filter by Date</label>
                        <input type="date" id="auditDateFilter" class="form-control" disabled>
                    </div>
                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>User</th>
                                <th>Action</th>
                                <th>Details</th>
                                <th>IP Address</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>2024-01-15 14:30:25</td>
                                <td>Admin User</td>
                                <td>User Created</td>
                                <td>Created new faculty account</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr>
                                <td>2024-01-15 12:15:10</td>
                                <td>Admin User</td>
                                <td>Post Published</td>
                                <td>Published internship post #WD-001</td>
                                <td>192.168.1.100</td>
                            </tr>
                            <tr>
                                <td>2024-01-15 09:45:00</td>
                                <td>Admin User</td>
                                <td>Login</td>
                                <td>Successful login to admin dashboard</td>
                                <td>192.168.1.100</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </main>
</div>

<div id="userModal" class="modal">
    <div class="modal-content medium">
        <div class="modal-header">
            <h3 id="userModalTitle">Add New User</h3>
            <button class="close-modal" onclick="closeModal('userModal')">&times;</button>
        </div>
        <div class="modal-body">
            <form id="userForm" onsubmit="saveUser(event)" class="form-grid">
                <div class="form-group">
                    <label for="userFirstName">First Name *</label>
                    <input type="text" id="userFirstName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="userLastName">Last Name</label>
                    <input type="text" id="userLastName" class="form-control">
                </div>
                <div class="form-group">
                    <label for="userEmail">Email (Login Username) *</label>
                    <input type="email" id="userEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="userPassword">Password (Login Password) *</label>
                    <input type="password" id="userPassword" class="form-control" minlength="8" required placeholder="Minimum 8 characters">
                </div>
                <div class="form-group">
                    <label for="userRole">Role *</label>
                    <select id="userRole" class="form-control" required>
                        <option value="">Select Role</option>
                        <option value="Faculty">Faculty</option>
                        <option value="HR">HR Staff</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="userGender">Gender</label>
                    <select id="userGender" class="form-control">
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="userMobile">Mobile Number</label>
                    <input type="tel" id="userMobile" class="form-control">
                </div>
                <div class="form-group">
                    <label for="userCity">City</label>
                    <input type="text" id="userCity" class="form-control">
                </div>
                <div class="form-group">
                    <label for="userDOB">Date of Birth</label>
                    <input type="text" id="userDOB" class="form-control" placeholder="DD/MM/YYYY">
                </div>
                <div class="form-group">
                    <label for="userAge">Age</label>
                    <input type="number" id="userAge" class="form-control" min="18" max="100">
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeModal('userModal')">Cancel</button>
            <button type="submit" form="userForm" class="btn btn-primary">Save User</button>
        </div>
    </div>
</div>

<div id="viewUserModal" class="modal">
    <div class="modal-content medium">
        <div class="modal-header">
            <h3>User Details</h3>
            <button class="close-modal" onclick="closeModal('viewUserModal')">&times;</button>
        </div>
        <div class="modal-body" id="viewUserContent"></div>
        <div class="modal-footer">
            <button class="btn btn-outline" onclick="closeModal('viewUserModal')">Close</button>
        </div>
    </div>
</div>
<!-- User Details Sheet -->
<div id="userSheet" class="sheet">
    <div class="sheet-header">
        <h3>User Details</h3>
        <button onclick="closeUserSheet()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #666;">&times;</button>
    </div>
    <div class="sheet-body">
        <div style="background: #f8f9fc; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">First Name</label>
                    <p id="viewFirstName" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Last Name</label>
                    <p id="viewLastName" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Email</label>
                    <p id="viewEmail" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Role</label>
                    <p id="viewRole" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Gender</label>
                    <p id="viewGender" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Mobile</label>
                    <p id="viewMobile" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">City</label>
                    <p id="viewCity" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Date of Birth</label>
                    <p id="viewDOB" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Age</label>
                    <p id="viewAge" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
                <div>
                    <label style="font-size: 0.75rem; color: #64748b; text-transform: uppercase; font-weight: 600;">Last Login</label>
                    <p id="viewLastLogin" style="margin: 0.5rem 0 0 0; font-size: 1rem; color: #1e293b; font-weight: 500;">-</p>
                </div>
            </div>
        </div>

        <!-- User Status Control -->
        <div style="background: #ffffff; padding: 1.5rem; border: 1px solid #e2e8f0; border-radius: 8px;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <label style="font-weight: 600; font-size: 1rem; color: #1e293b; display: block; margin-bottom: 0.25rem;">User Access Control</label>
                    <p style="margin: 0; font-size: 0.875rem; color: #64748b;">Enable or disable user login access</p>
                </div>
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <span id="sheetStatusBadge" class="badge badge-success">Active</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="sheetUserToggle" onchange="onSheetToggleChange()" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="sheet-footer">
        <button onclick="closeUserSheet()" class="btn btn-outline">Close</button>
    </div>
</div>
<script src="admin-api.js"></script>
<script>
    // ==========================================
    // PRODUCTION ADMIN PANEL - API INTEGRATED
    // TrackerPro v8.0 - Backend Connected
    // ==========================================
    
    console.log('‚úÖ TrackerPro Admin Panel - API Integrated Version');
    
    // Check authentication on page load
    (function() {
        const token = localStorage.getItem('authToken');
        const userInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');
        
        if (!token || userInfo.userType !== 'ADMIN') {
            alert('Unauthorized access. Please login as admin.');
            window.location.href = 'loginPage.html';
            return;
        }
        
        // Set token for API calls
        window.AdminAPI.setAuthToken(token);
        
        // Update admin name in header
        const userNameEl = document.querySelector('.user-name');
        const userAvatarEl = document.querySelector('.user-avatar');
        if (userNameEl && userInfo.firstName) {
            userNameEl.textContent = `${userInfo.firstName} ${userInfo.lastName || ''}`;
        }
        if (userAvatarEl && userInfo.firstName) {
            userAvatarEl.textContent = userInfo.firstName.charAt(0).toUpperCase();
        }
    })();
    // ==========================================
    // GLOBAL STATE & VARIABLES
    // ==========================================
    
    let editingInternshipId = null;
    let editingUserId = null;
    let currentViewUserId = null;
    let currentPage = 1;
    let currentUserFilter = 'all';
    const itemsPerPage = 10;
    
    // ==========================================
    // UTILITY FUNCTIONS
    // ==========================================
    
    function showAlert(message, type = 'info') {
        alert(message);
    }
    
    function showStatusMessage(message, type = 'success') {
        let container = document.getElementById('statusMessageContainer');
        if (!container) {
            container = document.createElement('div');
            container.id = 'statusMessageContainer';
            container.style.cssText = 'position: fixed; top: 90px; right: 20px; z-index: 10000;';
            document.body.appendChild(container);
        }

        const messageDiv = document.createElement('div');
        messageDiv.className = `alert alert-${type === 'success' ? 'success' : 'error'}`;
        messageDiv.textContent = message;
        messageDiv.style.cssText = `padding: 12px 24px; margin-bottom: 10px; border-radius: 8px; font-weight: 500; box-shadow: 0 4px 12px rgba(0,0,0,0.15); animation: slideIn 0.3s ease;`;
        container.appendChild(messageDiv);
        setTimeout(() => {
            messageDiv.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => messageDiv.remove(), 300);
        }, 3000);
    }
    
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
            modal.classList.remove('active');
        }
    }
    
    // ==========================================
    // NAVIGATION & PAGE MANAGEMENT
    // ==========================================
    
    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(page => {
            page.classList.remove('active-page');
        });

        const targetPage = document.getElementById(pageId);
        if (targetPage) {
            targetPage.classList.add('active-page');
        }

        document.querySelectorAll('.nav-item').forEach(nav => {
            nav.classList.remove('active');
        });

        const activeNav = document.querySelector(`[data-page="${pageId}"]`);
        if (activeNav) activeNav.classList.add('active');

        if (pageId === 'registrations') loadRegistrationsData();
        else if (pageId === 'user-management') loadUsersData();
        else if (pageId === 'internship-management') loadInternshipsData();
        else if (pageId === 'dashboard') updateDashboardStats();
    }

    function toggleSidebar() {
        const sidebar = document.getElementById('sidebar');
        if (sidebar) sidebar.classList.toggle('collapsed');
    }

    async function logout() {
        if (confirm('Are you sure you want to logout?')) {
            try {
                await window.AdminAPI.Auth.logout();
            } catch (error) {
                console.error('Logout error:', error);
            }
            localStorage.removeItem('authToken');
            localStorage.removeItem('userInfo');
            showAlert('Logged out successfully');
            window.location.href = 'loginPage.html';
        }
    }
    
    // ==========================================
    // DASHBOARD STATISTICS
    // ==========================================
    
    async function updateDashboardStats() {
        try {
            const response = await window.AdminAPI.Dashboard.getStats();
            
            const totalRegsEl = document.getElementById('totalRegistrations');
            const totalUsersEl = document.getElementById('totalUsers');
            const totalPostsEl = document.getElementById('totalPosts');
            const newUsersEl = document.getElementById('newUsers');

            if (totalRegsEl) totalRegsEl.textContent = response.totalStudents || 0;
            if (totalUsersEl) totalUsersEl.textContent = response.totalFacultyHR || 0;
            if (totalPostsEl) totalPostsEl.textContent = response.publishedPosts || 0;
            if (newUsersEl) newUsersEl.textContent = response.newStudentsThisWeek || 0;
        } catch (error) {
            console.error('Error loading dashboard stats:', error);
            showAlert('Error loading dashboard statistics');
        }
    }
    
    // ==========================================
    // STUDENT REGISTRATIONS MANAGEMENT
    // ==========================================
    
    async function loadRegistrationsData(page = 1) {
        try {
            const response = await window.AdminAPI.Registration.getAll();
            const registrations = response.data || [];
            const tbody = document.querySelector('#registrationsTable tbody');

            if (!tbody) return;

            currentPage = page;
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedData = registrations.slice(startIndex, endIndex);

            tbody.innerHTML = paginatedData.map(reg => `
                <tr>
                    <td><input type="checkbox" data-id="${reg.id}"></td>
                    <td>${reg.firstName || '-'}</td>
                    <td>${reg.lastName || '-'}</td>
                    <td>${reg.email || '-'}</td>
                    <td>${reg.gender || 'N/A'}</td>
                    <td>${reg.dob || 'N/A'}</td>
                    <td>${reg.location || 'N/A'}</td>
                    <td>${reg.mobileNo || '-'}</td>
                    <td><span class="badge badge-primary">STUDENT</span></td>
                    <td>${reg.createdAt ? new Date(reg.createdAt).toLocaleDateString() : 'N/A'}</td>
                    <td>
                        <div class="actions">
                            <button onclick="viewRegistration(${reg.id})" class="btn btn-sm btn-outline">View</button>
                            <button onclick="deleteRegistration(${reg.id})" class="btn btn-sm btn-danger">Delete</button>
                        </div>
                    </td>
                </tr>
            `).join('');

            updateRegistrationCounts(registrations.length, paginatedData.length);
            renderPagination(registrations.length);
            
            // Show/hide delete selected button
            const deleteBtn = document.getElementById('deleteSelectedBtn');
            if (deleteBtn) {
                deleteBtn.style.display = registrations.length > 0 ? 'inline-block' : 'none';
            }
        } catch (error) {
            console.error('Error loading registrations:', error);
            showAlert('Error loading student registrations');
        }
    }

    function updateRegistrationCounts(total, showing) {
        const showingEl = document.getElementById('registrationShowingCount');
        const totalEl = document.getElementById('registrationTotalCount');

        if (showingEl) showingEl.textContent = showing;
        if (totalEl) totalEl.textContent = total;
    }

    function renderPagination(totalItems) {
        const paginationEl = document.getElementById('registrationPagination');
        if (!paginationEl) return;

        const totalPages = Math.ceil(totalItems / itemsPerPage);

        let paginationHTML = `
            <button onclick="loadRegistrationsData(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
        `;

        for (let i = 1; i <= totalPages; i++) {
            paginationHTML += `<button onclick="loadRegistrationsData(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
        }

        paginationHTML += `
            <button onclick="loadRegistrationsData(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
        `;

        paginationEl.innerHTML = paginationHTML;
    }

    async function viewRegistration(id) {
        try {
            const response = await window.AdminAPI.Registration.getById(id);
            const registration = response.data;
            if (registration) {
                alert(`Student Details:\n\nName: ${registration.firstName} ${registration.lastName}\nEmail: ${registration.email}\nMobile: ${registration.mobileNo}\nGender: ${registration.gender || 'N/A'}\nDOB: ${registration.dob || 'N/A'}\nLocation: ${registration.location || 'N/A'}`);
            }
        } catch (error) {
            console.error('Error viewing registration:', error);
            showAlert('Error loading student details');
        }
    }

    async function deleteRegistration(id) {
        if (confirm('Are you sure you want to delete this registration?')) {
            try {
                await window.AdminAPI.Registration.delete(id);
                loadRegistrationsData(currentPage);
                updateDashboardStats();
                showStatusMessage('Registration deleted successfully', 'success');
            } catch (error) {
                console.error('Error deleting registration:', error);
                showAlert('Error deleting registration');
            }
        }
    }

    function filterRegistrations() {
        const searchInput = document.getElementById('registrationSearch');
        if (!searchInput) return;

        const searchTerm = searchInput.value.toLowerCase();
        const rows = document.querySelectorAll('#registrationsTable tbody tr');

        let visibleCount = 0;
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            const isVisible = text.includes(searchTerm);
            row.style.display = isVisible ? '' : 'none';
            if (isVisible) visibleCount++;
        });

        const showingEl = document.getElementById('registrationShowingCount');
        if (showingEl) showingEl.textContent = visibleCount;
    }

    function refreshRegistrations() {
        loadRegistrationsData(1);
        showStatusMessage('Registrations refreshed', 'success');
    }

    function toggleSelectAll() {
        const selectAll = document.getElementById('selectAll');
        const checkboxes = document.querySelectorAll('#registrationsTable tbody input[type="checkbox"]');
        checkboxes.forEach(cb => cb.checked = selectAll.checked);
    }

    async function deleteSelectedRegistrations() {
        const checkboxes = document.querySelectorAll('#registrationsTable tbody input[type="checkbox"]:checked');
        if (checkboxes.length === 0) {
            alert('No registrations selected');
            return;
        }

        if (confirm(`Delete ${checkboxes.length} selected registration(s)?`)) {
            try {
                const ids = Array.from(checkboxes).map(cb => parseInt(cb.getAttribute('data-id')));
                await window.AdminAPI.Registration.deleteMultiple(ids);
                loadRegistrationsData(currentPage);
                updateDashboardStats();
                showStatusMessage(`${checkboxes.length} registration(s) deleted`, 'success');
            } catch (error) {
                console.error('Error deleting registrations:', error);
                showAlert('Error deleting selected registrations');
            }
        }
    }

    async function exportRegistrations() {
        try {
            const response = await window.AdminAPI.Registration.exportData();
            const registrations = response.data || [];
            
            const csv = 'First Name,Last Name,Email,Mobile,Gender,DOB,Location,Registered On\n' +
                        registrations.map(r =>
                            `"${r.firstName}","${r.lastName}",${r.email},${r.mobileNo},${r.gender || ''},${r.dob || ''},${r.location || ''},${r.createdAt ? new Date(r.createdAt).toLocaleDateString() : ''}`
                        ).join('\n');

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `registrations_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showStatusMessage('Data exported successfully', 'success');
        } catch (error) {
            console.error('Error exporting registrations:', error);
            showAlert('Error exporting data');
        }
    }
    
    // ==========================================
    // USER MANAGEMENT (HR/FACULTY) - PRIORITY FEATURE
    // ==========================================
    
    async function loadUsersData(filterType = null) {
        if (filterType !== null) {
            currentUserFilter = filterType;
        }

        try {
            const filter = currentUserFilter === 'all' ? '' : currentUserFilter;
            const response = await window.AdminAPI.User.getAll({ filter });
            let users = response.data || [];

            const tbody = document.querySelector('#usersTable tbody');
            if (!tbody) return;

            tbody.innerHTML = users.map(user => `
                <tr>
                    <td>${user.firstName} ${user.lastName || ''}</td>
                    <td>${user.email}</td>
                    <td><span class="badge badge-${user.userType === 'FACULTY' ? 'primary' : 'info'}">${user.userType}</span></td>
                    <td><span class="badge badge-${user.isActive ? 'success' : 'disabled'}">${user.isActive ? 'Active' : 'Inactive'}</span></td>
                    <td>${user.updatedAt ? new Date(user.updatedAt).toLocaleDateString() : 'Never'}</td>
                    <td>
                        <div class="actions">
                            <button onclick="viewUser(${user.id})" class="btn btn-sm btn-outline">View</button>
                            <button onclick="editUser(${user.id})" class="btn btn-sm btn-primary">Edit</button>
                        </div>
                    </td>
                </tr>
            `).join('');

            updateFilterButtonStates();
        } catch (error) {
            console.error('Error loading users:', error);
            showAlert('Error loading user data');
        }
    }

    function updateFilterButtonStates() {
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
        });

        const activeBtn = document.querySelector(`.filter-btn[onclick*="'${currentUserFilter}'"]`);
        if (activeBtn) {
            activeBtn.classList.add('active');
        }
    }

    function filterUsers(type) {
        loadUsersData(type);
    }

    function openAddUserModal() {
        const modal = document.getElementById('userModal');
        const form = document.getElementById('userForm');
        const title = document.getElementById('userModalTitle');

        if (form) form.reset();
        if (title) title.textContent = 'Add New User';
        if (modal) modal.classList.add('active');

        editingUserId = null;
    }

    async function viewUser(id) {
        try {
            const response = await window.AdminAPI.User.getById(id);
            const user = response.data;
            if (!user) return;

            currentViewUserId = id;

            // Populate view fields
            document.getElementById('viewFirstName').textContent = user.firstName || '-';
            document.getElementById('viewLastName').textContent = user.lastName || '-';
            document.getElementById('viewEmail').textContent = user.email || '-';
            document.getElementById('viewRole').textContent = user.userType || '-';
            document.getElementById('viewGender').textContent = user.gender || '-';
            document.getElementById('viewMobile').textContent = user.mobileNo || '-';
            document.getElementById('viewCity').textContent = user.location || '-';
            document.getElementById('viewDOB').textContent = user.dob || '-';
            document.getElementById('viewAge').textContent = user.age || '-';
            document.getElementById('viewLastLogin').textContent = user.updatedAt ? new Date(user.updatedAt).toLocaleDateString() : 'Never';

            // Set toggle
            const toggleInput = document.getElementById('sheetUserToggle');
            if (toggleInput) {
                toggleInput.checked = user.isActive;
            }

            // Update status badge
            updateSheetStatusDisplay(user.isActive);

            // Show sheet
            document.getElementById('userSheet').classList.add('active');
        } catch (error) {
            console.error('Error viewing user:', error);
            showAlert('Error loading user details');
        }
    }

    async function editUser(id) {
        try {
            const response = await window.AdminAPI.User.getById(id);
            const user = response.data;
            if (!user) return;

            editingUserId = id;

            // Populate form fields
            document.getElementById('userFirstName').value = user.firstName || '';
            document.getElementById('userLastName').value = user.lastName || '';
            document.getElementById('userEmail').value = user.email || '';
            document.getElementById('userPassword').value = '';  // Don't show password
            document.getElementById('userRole').value = user.userType || '';
            document.getElementById('userGender').value = user.gender || '';
            document.getElementById('userMobile').value = user.mobileNo || '';
            document.getElementById('userCity').value = user.location || '';
            document.getElementById('userDOB').value = user.dob || '';
            document.getElementById('userAge').value = user.age || '';

            // Update modal title
            document.getElementById('userModalTitle').textContent = 'Edit User';

            // Show modal
            document.getElementById('userModal').classList.add('active');
        } catch (error) {
            console.error('Error loading user for edit:', error);
            showAlert('Error loading user details');
        }
    }

    function updateSheetStatusDisplay(isEnabled) {
        const statusBadge = document.getElementById('sheetStatusBadge');
        if (statusBadge) {
            statusBadge.textContent = isEnabled ? 'Active' : 'Inactive';
            statusBadge.className = `badge badge-${isEnabled ? 'success' : 'disabled'}`;
        }
    }

    async function onSheetToggleChange() {
        if (!currentViewUserId) return;

        const toggleInput = document.getElementById('sheetUserToggle');
        if (!toggleInput) return;

        const isEnabled = toggleInput.checked;

        try {
            await window.AdminAPI.User.toggleStatus(currentViewUserId, isEnabled);
            
            // Update display
            updateSheetStatusDisplay(isEnabled);

            // Refresh table
            loadUsersData();

            showStatusMessage(`User ${isEnabled ? 'enabled' : 'disabled'} successfully`, 'success');
        } catch (error) {
            console.error('Error toggling user status:', error);
            showAlert('Error updating user status');
            // Revert toggle
            toggleInput.checked = !isEnabled;
        }
    }

    function closeUserSheet() {
        document.getElementById('userSheet').classList.remove('active');
        currentViewUserId = null;
    }

    async function saveUser(event) {
        if (event) {
            event.preventDefault();
            event.stopPropagation();
        }

        try {
            const firstName = document.getElementById('userFirstName').value.trim();
            const lastName = document.getElementById('userLastName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            const password = document.getElementById('userPassword').value.trim();
            const userType = document.getElementById('userRole').value;
            const gender = document.getElementById('userGender').value;
            const mobileNo = document.getElementById('userMobile').value.trim();
            const location = document.getElementById('userCity').value.trim();
            const dob = document.getElementById('userDOB').value.trim();
            const age = parseInt(document.getElementById('userAge').value) || 0;

            if (!firstName || !email || (!editingUserId && !password) || !userType) {
                showAlert('Please fill all required fields');
                return false;
            }

            if (password && password.length < 6) {
                showAlert('Password must be at least 6 characters');
                return false;
            }

            const formData = {
                firstName,
                lastName,
                email,
                userType,
                gender,
                mobileNo,
                location,
                dob,
                age
            };
            
            // Only include password if it's provided
            if (password) {
                formData.password = password;
            }

            if (editingUserId) {
                // Update existing user
                await window.AdminAPI.User.update(editingUserId, formData);
                showStatusMessage('User updated successfully!', 'success');
            } else {
                // Add new user (password required)
                if (!password) {
                    showAlert('Password is required for new users');
                    return false;
                }
                await window.AdminAPI.User.create(formData);
                showStatusMessage('User added successfully!', 'success');
            }

            closeModal('userModal');
            loadUsersData();
            updateDashboardStats();
            editingUserId = null;

            return false;

        } catch (error) {
            console.error('Error saving user:', error);
            showAlert(error.message || 'Error saving user');
            return false;
        }
    }
    
    // ==========================================
    // INTERNSHIP/CAREER MANAGEMENT - PRIORITY FEATURE
    // ==========================================
    
    async function loadInternshipsData() {
        try {
            const response = await window.AdminAPI.Internship.getAll();
            const internships = response.data || [];
            const container = document.getElementById('internshipsList');

            if (!container) return;

            if (internships.length === 0) {
                container.innerHTML = '<div class="alert alert-info">No internship posts yet. Create your first post!</div>';
                return;
            }

            container.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
                    ${internships.map(internship => `
                        <div onclick="showPostPreview(${internship.id})" style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08); transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.boxShadow='0 8px 24px rgba(0,0,0,0.12)'" onmouseout="this.style.boxShadow='0 2px 8px rgba(0,0,0,0.08)'">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                                <div style="flex: 1;">
                                    <h3 style="margin: 0 0 0.5rem 0; font-size: 1.1rem; color: #1e293b; font-weight: 600;">${internship.title}</h3>
                                    <span style="display: inline-block; padding: 0.25rem 0.75rem; background: #e5eaff; color: #4a6fff; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">${internship.code}</span>
                                </div>
                                <span class="badge badge-${internship.status === 'Posted' ? 'success' : 'warning'}" style="font-size: 0.7rem; padding: 0.35rem 0.75rem;">${internship.status}</span>
                            </div>

                            <div style="margin-bottom: 1rem;">
                                <div style="display: flex; gap: 1.5rem; margin-bottom: 0.75rem; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; color: #475569;">
                                        <span>üßæ</span>
                                        <span style="font-weight: 500;">${internship.duration} months</span>
                                    </div>
                                    <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; color: #475569;">
                                        <span>üìç</span>
                                        <span style="font-weight: 500;">${internship.workMode}</span>
                                    </div>
                                </div>

                                <p style="font-size: 0.875rem; color: #475569; line-height: 1.6; margin: 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">${internship.description}</p>
                            </div>

                            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                                ${(internship.prerequisites || '').split(',').slice(0, 3).map(skill =>
                                    `<span style="padding: 0.25rem 0.6rem; background: #f0f0f0; color: #555; border-radius: 4px; font-size: 0.75rem;">${skill.trim()}</span>`
                                ).join('')}
                                ${(internship.prerequisites || '').split(',').length > 3 ? `<span style="padding: 0.25rem 0.6rem; background: #f0f0f0; color: #555; border-radius: 4px; font-size: 0.75rem;">+${(internship.prerequisites || '').split(',').length - 3}</span>` : ''}
                            </div>

                            <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                                <div style="display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 0.9rem; font-weight: 600; color: #4a6fff;">${internship.applicationsCount || 0} Applications</span>
                                </div>

                                <div style="display: flex; gap: 0.5rem;" onclick="event.stopPropagation()">
                                    <button onclick="togglePostStatus(${internship.id}, '${internship.status}')" class="btn btn-sm btn-${internship.status === 'Posted' ? 'warning' : 'success'}" style="font-size: 0.75rem; padding: 0.4rem 0.7rem;">
                                        ${internship.status === 'Posted' ? 'Unpublish' : 'Publish'}
                                    </button>
                                    <button onclick="deleteInternship(${internship.id})" class="btn btn-sm btn-danger" style="font-size: 0.75rem; padding: 0.4rem 0.7rem;">Delete</button>
                                </div>
                            </div>

                            ${internship.createdAt ? `<div style="font-size: 0.75rem; color: #64748b; margin-top: 0.75rem; text-align: right;">Posted: ${new Date(internship.createdAt).toLocaleDateString()}</div>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        } catch (error) {
            console.error('Error loading internships:', error);
            showAlert('Error loading internship data');
        }
    }

    async function showPostPreview(postId) {
        try {
            const response = await window.AdminAPI.Internship.getById(postId);
            const internship = response.data;
            if (!internship) return;

            const previewHTML = `
                <div class="preview-container">
                    <div class="preview-field"><div class="preview-label">Internship ID</div><div class="preview-value">${internship.code}</div></div>
                    <div class="preview-field"><div class="preview-label">Title</div><div class="preview-value"><strong>${internship.title}</strong></div></div>
                    <div class="preview-field"><div class="preview-label">Duration</div><div class="preview-value">${internship.duration} months</div></div>
                    <div class="preview-field"><div class="preview-label">Work Mode</div><div class="preview-value">${internship.workMode}</div></div>
                    <div class="preview-field"><div class="preview-label">Required Skills</div><div class="preview-value">${internship.prerequisites}</div></div>
                    <div class="preview-field"><div class="preview-label">Status</div><div class="preview-value"><span class="badge badge-${internship.status === 'Posted' ? 'success' : 'warning'}">${internship.status}</span></div></div>
                    <div class="preview-field"><div class="preview-label">Applications Received</div><div class="preview-value">${internship.applicationsCount || 0}</div></div>
                    ${internship.createdAt ? `<div class="preview-field"><div class="preview-label">Posted Date</div><div class="preview-value">${new Date(internship.createdAt).toLocaleDateString()}</div></div>` : ''}
                    <div class="preview-field"><div class="preview-label">Description</div><div class="preview-value">${internship.description}</div></div>
                </div>
            `;

            document.getElementById('previewContent').innerHTML = previewHTML;

            const footer = document.getElementById('previewModalFooter');
            if (footer) {
                footer.innerHTML = `
                    <button class="btn btn-outline" onclick="closeModal('previewModal')">Close</button>
                    <button class="btn btn-primary" onclick="closeModal('previewModal');editInternship(${postId})">‚úèÔ∏è Edit</button>
                `;
            }

            document.getElementById('previewModal').classList.add('active');
        } catch (error) {
            console.error('Error showing post preview:', error);
            showAlert('Error loading internship details');
        }
    }

    function toggleInternshipForm() {
        const modal = document.getElementById('internshipFormSheet');
        if (modal) {
            modal.classList.toggle('active');
            if (!modal.classList.contains('active')) {
                document.getElementById('internshipForm').reset();
                editingInternshipId = null;
                document.getElementById('internshipModalTitle').textContent = 'Create New Post';
            }
        }
    }

    async function saveInternship(event) {
        if (event) event.preventDefault();

        const code = document.getElementById('internshipCode').value.trim();
        const title = document.getElementById('internshipTitle').value.trim();
        const duration = parseInt(document.getElementById('internshipDuration').value);
        const workMode = document.getElementById('internshipWorkMode').value;
        const prerequisites = document.getElementById('internshipPrerequisites').value.trim();
        const description = document.getElementById('internshipDescription').value.trim();
        const status = document.getElementById('internshipStatus').value;

        if (!code || !title || !duration) {
            showAlert('Please fill all required fields');
            return;
        }

        try {
            const formData = {
                code,
                title,
                duration,
                workMode,
                prerequisites,
                description,
                status
            };

            if (editingInternshipId) {
                await window.AdminAPI.Internship.update(editingInternshipId, formData);
                showStatusMessage('Internship updated successfully', 'success');
            } else {
                await window.AdminAPI.Internship.create(formData);
                showStatusMessage('Internship created successfully', 'success');
            }
            
            toggleInternshipForm();
            loadInternshipsData();
            updateDashboardStats();
        } catch (error) {
            console.error('Error saving internship:', error);
            showAlert(error.message || 'Error saving internship');
        }
    }

    async function editInternship(id) {
        try {
            const response = await window.AdminAPI.Internship.getById(id);
            const internship = response.data;
            if (internship) {
                editingInternshipId = id;
                document.getElementById('internshipCode').value = internship.code;
                document.getElementById('internshipTitle').value = internship.title;
                document.getElementById('internshipDuration').value = internship.duration || '';
                document.getElementById('internshipWorkMode').value = internship.workMode;
                document.getElementById('internshipPrerequisites').value = internship.prerequisites;
                document.getElementById('internshipDescription').value = internship.description;
                document.getElementById('internshipStatus').value = internship.status;
                document.getElementById('internshipModalTitle').textContent = 'Edit Internship Post';
                document.getElementById('internshipFormSheet').classList.add('active');
            }
        } catch (error) {
            console.error('Error loading internship for edit:', error);
            showAlert('Error loading internship details');
        }
    }

    async function togglePostStatus(id, currentStatus) {
        try {
            const newStatus = currentStatus === 'Posted' ? 'Draft' : 'Posted';
            await window.AdminAPI.Internship.toggleStatus(id, newStatus);
            loadInternshipsData();
            updateDashboardStats();
            showStatusMessage(`Internship ${newStatus.toLowerCase()} successfully`, 'success');
        } catch (error) {
            console.error('Error toggling post status:', error);
            showAlert('Error updating internship status');
        }
    }

    async function deleteInternship(id) {
        if (confirm('Are you sure you want to delete this internship?')) {
            try {
                await window.AdminAPI.Internship.delete(id);
                loadInternshipsData();
                updateDashboardStats();
                showStatusMessage('Internship deleted successfully', 'success');
            } catch (error) {
                console.error('Error deleting internship:', error);
                showAlert('Error deleting internship');
            }
        }
    }

    function previewPost() {
        const code = document.getElementById('internshipCode').value;
        const title = document.getElementById('internshipTitle').value;
        const duration = document.getElementById('internshipDuration').value;
        const workMode = document.getElementById('internshipWorkMode').value;
        const skills = document.getElementById('internshipPrerequisites').value;
        const description = document.getElementById('internshipDescription').value;
        const status = document.getElementById('internshipStatus').value;

        const previewHTML = `
            <div class="preview-container">
                <div class="preview-field"><div class="preview-label">Internship ID</div><div class="preview-value">${code}</div></div>
                <div class="preview-field"><div class="preview-label">Title</div><div class="preview-value"><strong>${title}</strong></div></div>
                <div class="preview-field"><div class="preview-label">Duration</div><div class="preview-value">${duration} Months</div></div>
                <div class="preview-field"><div class="preview-label">Work Mode</div><div class="preview-value">${workMode}</div></div>
                <div class="preview-field"><div class="preview-label">Required Skills</div><div class="preview-value">${skills}</div></div>
                <div class="preview-field"><div class="preview-label">Status</div><div class="preview-value"><span class="badge badge-${status === 'Posted' ? 'success' : 'warning'}">${status}</span></div></div>
                <div class="preview-field"><div class="preview-label">Description</div><div class="preview-value">${description}</div></div>
            </div>
        `;
        document.getElementById('previewContent').innerHTML = previewHTML;

        const footer = document.getElementById('previewModalFooter');
        if (footer) {
            footer.innerHTML = `<button class="btn btn-outline" onclick="closeModal('previewModal')">Close</button>`;
        }

        document.getElementById('previewModal').classList.add('active');
    }

    function showSettingsTab(tabName) {
        document.querySelectorAll('.settings-content').forEach(content => content.classList.remove('active'));
        document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.remove('active'));
        const targetContent = document.getElementById(tabName + 'Settings');
        if (targetContent) targetContent.classList.add('active');
        if (event && event.target) event.target.classList.add('active');
    }
    
    // ==========================================
    // INITIALIZATION
    // ==========================================
    
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üöÄ TrackerPro Admin Panel v8.0 - API Connected');
        
        // Load initial data
        updateDashboardStats();
        loadRegistrationsData(1);
        loadUsersData('all');

        // Setup navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                const pageId = this.getAttribute('data-page');
                if (pageId) showPage(pageId);
            });
        });

        // Modal click outside to close
        window.onclick = function(event) {
            if (event.target.classList.contains('modal') || event.target.classList.contains('sheet')) {
                if (event.target.id === 'userSheet') {
                    closeUserSheet();
                } else {
                    event.target.classList.remove('active');
                }
            }
        };
    });

    // ==========================================
    // CSS ANIMATIONS & STYLES
    // ==========================================
    
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideIn { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(400px); opacity: 0; } }
        .preview-container { padding: 1rem; }
        .preview-field { margin-bottom: 1rem; }
        .preview-label { font-weight: 600; color: #475569; margin-bottom: 0.25rem; font-size: 0.875rem; }
        .preview-value { color: #1e293b; line-height: 1.6; }

        .toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .3s; border-radius: 26px; }
        .toggle-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; }
        .toggle-switch input:checked + .toggle-slider { background-color: #2ecc71; }
        .toggle-switch input:checked + .toggle-slider:before { transform: translateX(24px); }

        .sheet { display: none; position: fixed; top: 0; right: -100%; width: 500px; height: 100%; background: white; box-shadow: -4px 0 12px rgba(0,0,0,0.15); z-index: 9999; transition: right 0.3s ease; overflow-y: auto; }
        .sheet.active { display: block; right: 0; }
        .sheet-header { padding: 1.5rem; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; background: #f8f9fc; }
        .sheet-body { padding: 1.5rem; }
        .sheet-footer { padding: 1.5rem; border-top: 1px solid #e2e8f0; display: flex; justify-content: flex-end; gap: 0.75rem; position: sticky; bottom: 0; background: white; box-shadow: 0 -2px 8px rgba(0,0,0,0.05); }

        .filter-btn.active { background-color: var(--primary-color); color: white; }
    `;
    document.head.appendChild(style);
</script>
                      id: i + 1,
                      candidateId: `STU-${String(i + 1).padStart(3, '0')}`,
                      firstName: `Student${i + 1}`,
                      lastName: `LastName${i + 1}`,
                      email: `student${i + 1}@example.com`,
                      password: "password123",
                      mobileNo: `98${String(i).padStart(8, '0')}`,
                      gender: i % 2 === 0 ? "Male" : "Female",
                      dob: "01/01/2000",
                      city: "City" + (i % 5),
                      address: `Address ${i}`,
                      role: "Student",
                      isActive: true,
                      createdAt: "2023-11-10",
                      lastLogin: null
                  })),

                  users: [

                      {
                          id: 1,
                          firstName: "Priya",
                          lastName: "Patel",
                          name: "Ms. Priya Patel",
                          email: "priya.patel@trackerpro.com",
                          password: "hr123456",
                          role: "HR",
                          gender: "Female",
                          mobile: "9123456789",
                          city: "Mumbai",
                          dob: "1990-07-22",
                          age: 34,
                          status: "Active",
                          isEnabled: true,
                          lastLogin: "2024-11-21"
                      },
                      {
                          id: 2,
                          firstName: "Rajesh",
                          lastName: "Kumar",
                          name: "Prof. Rajesh Kumar",
                          email: "rajesh.kumar@trackerpro.com",
                          password: "faculty456",
                          role: "Faculty",
                          gender: "Male",
                          mobile: "9988776655",
                          city: "Bangalore",
                          dob: "1980-05-10",
                          age: 44,
                          status: "Inactive",
                          isEnabled: false,
                          lastLogin: "2024-10-15"
                      }
                  ],

                  internships: [
                      {
                          id: 1,
                          internshipId: "WD-001",
                          internshipTitle: "Full Stack Web Development Internship",
                          duration: "6 Months",
                          workMode: "Hybrid",
                          skills: "HTML, CSS, JavaScript, React, Node.js, MongoDB, REST APIs",
                          description: "Complete full-stack web development internship program covering frontend and backend technologies with hands-on project experience.",
                          status: "PUBLISHED",
                          postedDate: "2024-11-15",
                          createdBy: "HR-ADMIN-001",
                          applicationsReceived: 25
                      },
                      {
                          id: 2,
                          internshipId: "DS-002",
                          internshipTitle: "Data Science Fundamentals",
                          duration: "4 Months",
                          workMode: "Online",
                          skills: "Python, SQL, Statistics, Machine Learning, Pandas, NumPy",
                          description: "Introduction to data science with focus on statistical analysis, machine learning algorithms, and data visualization techniques.",
                          status: "PUBLISHED",
                          postedDate: "2024-11-14",
                          createdBy: "HR-ADMIN-001",
                          applicationsReceived: 18
                      },
                  ],

                  applications: [],
                  interviews: [],
                  complaints: [],
                  settings: {
                      systemName: "Student Progress Tracking System",
                      supportEmail: "contactus@trackerpro.com",
                      organizationName: "Educational Institute",
                      academicYear: "2024-2025"
                  }
              };

              localStorage.setItem(this.STORAGE_KEY, JSON.stringify(initialData));
          } else {
              try {
                  const data = JSON.parse(existingData);
                  if (!data.users || !Array.isArray(data.users)) {
                      data.users = [];
                      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                  }
                  if (!data.registrations || !Array.isArray(data.registrations)) {
                      data.registrations = [];
                      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                  }
                  if (!data.internships || !Array.isArray(data.internships)) {
                      data.internships = [];
                      localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
                  }
              } catch (e) {
                  localStorage.removeItem(this.STORAGE_KEY);
                  this.initializeData();
              }
          }
      }

      getData() {
          const data = JSON.parse(localStorage.getItem(this.STORAGE_KEY));
          if (!data.users) data.users = [];
          if (!data.registrations) data.registrations = [];
          if (!data.internships) data.internships = [];
          return data;
      }

      saveData(data) {
          localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
      }

      getRegistrations() {
          return this.getData().registrations || [];
      }

      deleteRegistration(id) {
          const data = this.getData();
          data.registrations = data.registrations.filter(r => r.id !== id);
          this.saveData(data);
      }

      getUsers() {
          return this.getData().users || [];
      }

      addUser(userData) {
          const data = this.getData();
          if (!data.users || !Array.isArray(data.users)) {
              data.users = [];
          }

          const newId = (data.users.length > 0 ? Math.max(...data.users.map(u => u.id)) : 0) + 1;

          const newUser = {
              id: newId,
              firstName: userData.firstName,
              lastName: userData.lastName || '',
              name: `${userData.firstName} ${userData.lastName || ''}`.trim(),
              email: userData.email,
              password: userData.password,
              role: userData.role,
              gender: userData.gender || '',
              mobile: userData.mobile || '',
              city: userData.city || '',
              dob: userData.dob || '',
              age: userData.age || null,
              status: 'Active',
              isEnabled: true,
              lastLogin: null
          };

          data.users.push(newUser);
          this.saveData(data);
          return newUser;
      }

      updateUser(id, userData) {
          const data = this.getData();
          const index = data.users.findIndex(u => u.id === id);
          if (index !== -1) {
              data.users[index] = {
                  ...data.users[index],
                  firstName: userData.firstName,
                  lastName: userData.lastName || '',
                  name: `${userData.firstName} ${userData.lastName || ''}`.trim(),
                  email: userData.email,
                  password: userData.password,
                  role: userData.role,
                  gender: userData.gender || '',
                  mobile: userData.mobile || '',
                  city: userData.city || '',
                  dob: userData.dob || '',
                  age: userData.age || null
              };
              this.saveData(data);
              return data.users[index];
          }
          return null;
      }

      deleteUser(id) {
          const data = this.getData();
          data.users = data.users.filter(u => u.id !== id);
          this.saveData(data);
      }

      toggleUserStatus(id) {
          const data = this.getData();
          const index = data.users.findIndex(u => u.id === id);
          if (index !== -1) {
              data.users[index].isEnabled = !data.users[index].isEnabled;
              data.users[index].status = data.users[index].isEnabled ? 'Active' : 'Inactive';
              this.saveData(data);
              return data.users[index];
          }
          return null;
      }

      getInternships() {
          return this.getData().internships || [];
      }

      addInternship(internship) {
          const data = this.getData();
          internship.id = (data.internships.length > 0 ? Math.max(...data.internships.map(i => i.id)) : 0) + 1;
          internship.applicationsReceived = 0;
          internship.postedDate = internship.status === 'PUBLISHED' ? new Date().toISOString().split('T')[0] : null;
          internship.createdBy = 'HR-ADMIN-001';
          data.internships.push(internship);
          this.saveData(data);
          return internship;
      }

      updateInternship(id, updates) {
          const data = this.getData();
          const index = data.internships.findIndex(i => i.id === id);
          if (index !== -1) {
              const oldStatus = data.internships[index].status;
              data.internships[index] = { ...data.internships[index], ...updates };

              if (oldStatus !== 'PUBLISHED' && updates.status === 'PUBLISHED') {
                  data.internships[index].postedDate = new Date().toISOString().split('T')[0];
              }

              this.saveData(data);
              return data.internships[index];
          }
          return null;
      }

      deleteInternship(id) {
          const data = this.getData();
          data.internships = data.internships.filter(i => i.id !== id);
          this.saveData(data);
      }

  }

  const dataManager = new DataManager();
  let editingInternshipId = null;
  let editingUserId = null;
  let currentViewUserId = null;
  let currentPage = 1;
  let currentUserFilter = 'all';
  const itemsPerPage = 10;

  function showPage(pageId) {
      document.querySelectorAll('.page').forEach(page => {
          page.classList.remove('active-page');
      });

      const targetPage = document.getElementById(pageId);
      if (targetPage) {
          targetPage.classList.add('active-page');
      }

      document.querySelectorAll('.nav-item').forEach(nav => {
          nav.classList.remove('active');
      });

      const activeNav = document.querySelector(`[data-page="${pageId}"]`);
      if (activeNav) activeNav.classList.add('active');

      if (pageId === 'registrations') loadRegistrationsData();
      else if (pageId === 'user-management') loadUsersData();
      else if (pageId === 'internship-management') loadInternshipsData();
      else if (pageId === 'dashboard') updateDashboardStats();
  }

  function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      if (sidebar) sidebar.classList.toggle('collapsed');
  }

  function logout() {
      if (confirm('Are you sure you want to logout?')) {
          alert('Logged out successfully');
      }
  }

  function updateDashboardStats() {
      const registrations = dataManager.getRegistrations();
      const users = dataManager.getUsers();
      const internships = dataManager.getInternships();

      const totalRegsEl = document.getElementById('totalRegistrations');
      const totalUsersEl = document.getElementById('totalUsers');
      const totalPostsEl = document.getElementById('totalPosts');
      const newUsersEl = document.getElementById('newUsers');

      if (totalRegsEl) totalRegsEl.textContent = registrations.length;
      if (totalUsersEl) totalUsersEl.textContent = users.length;
      if (totalPostsEl) totalPostsEl.textContent = internships.filter(i => i.status === 'PUBLISHED').length;
      if (newUsersEl) newUsersEl.textContent = registrations.filter(r => {
          const regDate = new Date(r.createdAt);
          const weekAgo = new Date();
          weekAgo.setDate(weekAgo.getDate() - 7);
          return regDate >= weekAgo;
      }).length;
  }

  // REGISTRATIONS
  function loadRegistrationsData(page = 1) {
      const registrations = dataManager.getRegistrations();
      const tbody = document.querySelector('#registrationsTable tbody');

      if (!tbody) return;

      currentPage = page;
      const startIndex = (page - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const paginatedData = registrations.slice(startIndex, endIndex);

      tbody.innerHTML = paginatedData.map(reg => `
          <tr>
              <td><input type="checkbox" data-id="${reg.id}"></td>
              <td>${reg.firstName}</td>
              <td>${reg.lastName}</td>
              <td>${reg.email}</td>
              <td>${reg.gender || 'N/A'}</td>
              <td>${reg.dob || 'N/A'}</td>
              <td>${reg.city || 'N/A'}</td>
              <td>${reg.mobileNo}</td>
              <td><span class="badge badge-${reg.role === 'Student' ? 'primary' : 'info'}">${reg.role}</span></td>
              <td>${reg.createdAt}</td>
              <td>
                  <div class="actions">
                      <button onclick="viewRegistration(${reg.id})" class="btn btn-sm btn-outline">View</button>
                      <button onclick="deleteRegistration(${reg.id})" class="btn btn-sm btn-danger">Delete</button>
                  </div>
              </td>
          </tr>
      `).join('');

      updateRegistrationCounts(registrations.length, paginatedData.length);
      renderPagination(registrations.length);
  }

  function updateRegistrationCounts(total, showing) {
      const showingEl = document.getElementById('registrationShowingCount');
      const totalEl = document.getElementById('registrationTotalCount');

      if (showingEl) showingEl.textContent = showing;
      if (totalEl) totalEl.textContent = total;
  }

  function renderPagination(totalItems) {
      const paginationEl = document.getElementById('registrationPagination');
      if (!paginationEl) return;

      const totalPages = Math.ceil(totalItems / itemsPerPage);

      let paginationHTML = `
          <button onclick="loadRegistrationsData(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
      `;

      for (let i = 1; i <= totalPages; i++) {
          paginationHTML += `<button onclick="loadRegistrationsData(${i})" class="${i === currentPage ? 'active' : ''}">${i}</button>`;
      }

      paginationHTML += `
          <button onclick="loadRegistrationsData(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
      `;

      paginationEl.innerHTML = paginationHTML;
  }

  function viewRegistration(id) {
      const registration = dataManager.getRegistrations().find(r => r.id === id);
      if (registration) {
          alert(`Student Details:\n\nCandidate ID: ${registration.candidateId}\nName: ${registration.firstName} ${registration.lastName}\nEmail: ${registration.email}\nMobile: ${registration.mobileNo}\nGender: ${registration.gender}\nDOB: ${registration.dob}\nCity: ${registration.city}`);
      }
  }

  function deleteRegistration(id) {
      if (confirm('Are you sure you want to delete this registration?')) {
          dataManager.deleteRegistration(id);
          loadRegistrationsData(currentPage);
          updateDashboardStats();
          showStatusMessage('Registration deleted successfully', 'success');
      }
  }

  function filterRegistrations() {
      const searchInput = document.getElementById('registrationSearch');
      if (!searchInput) return;

      const searchTerm = searchInput.value.toLowerCase();
      const rows = document.querySelectorAll('#registrationsTable tbody tr');

      let visibleCount = 0;
      rows.forEach(row => {
          const text = row.textContent.toLowerCase();
          const isVisible = text.includes(searchTerm);
          row.style.display = isVisible ? '' : 'none';
          if (isVisible) visibleCount++;
      });

      const showingEl = document.getElementById('registrationShowingCount');
      if (showingEl) showingEl.textContent = visibleCount;
  }

  function refreshRegistrations() {
      loadRegistrationsData(1);
      showStatusMessage('Registrations refreshed', 'success');
  }

  function toggleSelectAll() {
      const selectAll = document.getElementById('selectAll');
      const checkboxes = document.querySelectorAll('#registrationsTable tbody input[type="checkbox"]');
      checkboxes.forEach(cb => cb.checked = selectAll.checked);
  }

  function deleteSelectedRegistrations() {
      const checkboxes = document.querySelectorAll('#registrationsTable tbody input[type="checkbox"]:checked');
      if (checkboxes.length === 0) {
          alert('No registrations selected');
          return;
      }

      if (confirm(`Delete ${checkboxes.length} selected registration(s)?`)) {
          checkboxes.forEach(cb => {
              const id = parseInt(cb.getAttribute('data-id'));
              dataManager.deleteRegistration(id);
          });
          loadRegistrationsData(currentPage);
          updateDashboardStats();
          showStatusMessage(`${checkboxes.length} registration(s) deleted`, 'success');
      }
  }

  function exportRegistrations() {
      const registrations = dataManager.getRegistrations();
      const csv = 'Candidate ID,First Name,Last Name,Email,Mobile,Gender,DOB,City,Role,Registered On\n' +
                  registrations.map(r =>
                      `${r.candidateId},"${r.firstName}","${r.lastName}",${r.email},${r.mobileNo},${r.gender || ''},${r.dob || ''},${r.city || ''},${r.role},${r.createdAt}`
                  ).join('\n');

      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'registrations.csv';
      a.click();
      window.URL.revokeObjectURL(url);
  }


  // USER MANAGEMENT - VIEW & EDIT BUTTONS
  function loadUsersData(filterType = null) {
      if (filterType !== null) {
          currentUserFilter = filterType;
      }

      const allUsers = dataManager.getUsers();
      let users = allUsers;

      if (currentUserFilter === 'faculty') {
          users = allUsers.filter(u => u.role.toLowerCase() === 'faculty');
      } else if (currentUserFilter === 'hr') {
          users = allUsers.filter(u => u.role.toLowerCase() === 'hr');
      }

      const tbody = document.querySelector('#usersTable tbody');
      if (!tbody) return;

      tbody.innerHTML = users.map(user => `
          <tr>
              <td>${user.name || (user.firstName + ' ' + user.lastName).trim()}</td>
              <td>${user.email}</td>
              <td><span class="badge badge-${user.role === 'Faculty' ? 'primary' : 'info'}">${user.role}</span></td>
              <td><span class="badge badge-${user.status === 'Active' ? 'success' : 'disabled'}">${user.status}</span></td>
              <td>${user.lastLogin || 'Never'}</td>
              <td>
                  <div class="actions">
                      <button onclick="viewUser(${user.id})" class="btn btn-sm btn-outline">View</button>
                      <button onclick="editUser(${user.id})" class="btn btn-sm btn-primary">Edit</button>
                  </div>
              </td>
          </tr>
      `).join('');

      updateFilterButtonStates();
  }

  function updateFilterButtonStates() {
      document.querySelectorAll('.filter-btn').forEach(btn => {
          btn.classList.remove('active');
      });

      const activeBtn = document.querySelector(`.filter-btn[onclick*="'${currentUserFilter}'"]`);
      if (activeBtn) {
          activeBtn.classList.add('active');
      }
  }

  function filterUsers(type) {
      loadUsersData(type);
  }

  function openAddUserModal() {
      const modal = document.getElementById('userModal');
      const form = document.getElementById('userForm');
      const title = document.getElementById('userModalTitle');

      if (form) form.reset();
      if (title) title.textContent = 'Add New User';
      if (modal) modal.classList.add('active');

      editingUserId = null;
  }

  // VIEW USER - Opens Sheet with Details + Toggle
  function viewUser(id) {
      const user = dataManager.getUsers().find(u => u.id === id);
      if (!user) return;

      currentViewUserId = id;

      // Populate view fields
      document.getElementById('viewFirstName').textContent = user.firstName || '-';
      document.getElementById('viewLastName').textContent = user.lastName || '-';
      document.getElementById('viewEmail').textContent = user.email || '-';
      document.getElementById('viewRole').textContent = user.role || '-';
      document.getElementById('viewGender').textContent = user.gender || '-';
      document.getElementById('viewMobile').textContent = user.mobile || '-';
      document.getElementById('viewCity').textContent = user.city || '-';
      document.getElementById('viewDOB').textContent = user.dob || '-';
      document.getElementById('viewAge').textContent = user.age || '-';
      document.getElementById('viewLastLogin').textContent = user.lastLogin || 'Never';

      // Set toggle
      const toggleInput = document.getElementById('sheetUserToggle');
      if (toggleInput) {
          toggleInput.checked = user.isEnabled !== false;
      }

      // Update status badge
      updateSheetStatusDisplay(user.isEnabled !== false);

      // Show sheet
      document.getElementById('userSheet').classList.add('active');
  }

  // EDIT USER - Opens Add User Modal with Populated Fields
  function editUser(id) {
      const user = dataManager.getUsers().find(u => u.id === id);
      if (!user) return;

      editingUserId = id;

      // Populate form fields
      document.getElementById('userFirstName').value = user.firstName || '';
      document.getElementById('userLastName').value = user.lastName || '';
      document.getElementById('userEmail').value = user.email || '';
      document.getElementById('userPassword').value = user.password || '';
      document.getElementById('userRole').value = user.role || '';
      document.getElementById('userGender').value = user.gender || '';
      document.getElementById('userMobile').value = user.mobile || '';
      document.getElementById('userCity').value = user.city || '';
      document.getElementById('userDOB').value = user.dob || '';
      document.getElementById('userAge').value = user.age || '';

      // Update modal title
      document.getElementById('userModalTitle').textContent = 'Edit User';

      // Show modal
      document.getElementById('userModal').classList.add('active');
  }

  function updateSheetStatusDisplay(isEnabled) {
      const statusBadge = document.getElementById('sheetStatusBadge');
      if (statusBadge) {
          statusBadge.textContent = isEnabled ? 'Active' : 'Inactive';
          statusBadge.className = `badge badge-${isEnabled ? 'success' : 'disabled'}`;
      }
  }

  function onSheetToggleChange() {
      if (!currentViewUserId) return;

      const toggleInput = document.getElementById('sheetUserToggle');
      if (!toggleInput) return;

      const isEnabled = toggleInput.checked;

      // Update status in database
      const data = dataManager.getData();
      const index = data.users.findIndex(u => u.id === currentViewUserId);
      if (index !== -1) {
          data.users[index].isEnabled = isEnabled;
          data.users[index].status = isEnabled ? 'Active' : 'Inactive';
          dataManager.saveData(data);

          // Update display
          updateSheetStatusDisplay(isEnabled);

          // Refresh table
          loadUsersData();

          showStatusMessage(`User ${isEnabled ? 'enabled' : 'disabled'} successfully`, 'success');
      }
  }

  function closeUserSheet() {
      document.getElementById('userSheet').classList.remove('active');
      currentViewUserId = null;
  }

  function saveUser(event) {
      if (event) {
          event.preventDefault();
          event.stopPropagation();
      }

      try {
          const firstName = document.getElementById('userFirstName').value.trim();
          const lastName = document.getElementById('userLastName').value.trim();
          const email = document.getElementById('userEmail').value.trim();
          const password = document.getElementById('userPassword').value.trim();
          const role = document.getElementById('userRole').value;
          const gender = document.getElementById('userGender').value;
          const mobile = document.getElementById('userMobile').value.trim();
          const city = document.getElementById('userCity').value.trim();
          const dob = document.getElementById('userDOB').value.trim();
          const age = parseInt(document.getElementById('userAge').value) || null;

          if (!firstName || !email || !password || !role) {
              showStatusMessage('Please fill all required fields', 'error');
              return false;
          }

          if (password.length < 8) {
              showStatusMessage('Password must be at least 8 characters', 'error');
              return false;
          }

          const formData = {
              firstName, lastName, email, password, role,
              gender, mobile, city, dob, age
          };

          if (editingUserId) {
              // Update existing user
              dataManager.updateUser(editingUserId, formData);
              showStatusMessage('User updated!', 'success');
          } else {
              // Add new user
              dataManager.addUser(formData);
              showStatusMessage('User added!', 'success');
          }

          closeModal('userModal');
          loadUsersData();
          updateDashboardStats();
          editingUserId = null;

          return false;

      } catch (error) {
          console.error('Error:', error);
          showStatusMessage('Error: ' + error.message, 'error');
          return false;
      }
  }

  // INTERNSHIPS
  function loadInternshipsData() {
      const internships = dataManager.getInternships();
      const container = document.getElementById('internshipsList');

      if (!container) return;

      if (internships.length === 0) {
          container.innerHTML = '<div class="alert alert-info">No internship posts yet. Create your first post!</div>';
          return;
      }

      container.innerHTML = `
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
              ${internships.map(internship => `
                  <div onclick="showPostPreview(${internship.id})" style="background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 1.5rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08); transition: all 0.3s ease; cursor: pointer;" onmouseover="this.style.boxShadow='0 8px 24px rgba(0,0,0,0.12)'" onmouseout="this.style.boxShadow='0 2px 8px rgba(0,0,0,0.08)'">
                      <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                          <div style="flex: 1;">
                              <h3 style="margin: 0 0 0.5rem 0; font-size: 1.1rem; color: #1e293b; font-weight: 600;">${internship.internshipTitle}</h3>
                              <span style="display: inline-block; padding: 0.25rem 0.75rem; background: #e5eaff; color: #4a6fff; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">${internship.internshipId}</span>
                          </div>
                          <span class="badge badge-${internship.status === 'PUBLISHED' ? 'success' : 'warning'}" style="font-size: 0.7rem; padding: 0.35rem 0.75rem;">${internship.status}</span>
                      </div>

                      <div style="margin-bottom: 1rem;">
                          <div style="display: flex; gap: 1.5rem; margin-bottom: 0.75rem; flex-wrap: wrap;">
                              <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; color: #475569;">
                                  <span>üßæ</span>
                                  <span style="font-weight: 500;">${internship.duration}</span>
                              </div>
                              <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; color: #475569;">
                                  <span>üìç</span>
                                  <span style="font-weight: 500;">${internship.workMode}</span>
                              </div>
                          </div>

                          <p style="font-size: 0.875rem; color: #475569; line-height: 1.6; margin: 0; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">${internship.description}</p>
                      </div>

                      <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1rem;">
                          ${internship.skills.split(',').slice(0, 3).map(skill =>
                              `<span style="padding: 0.25rem 0.6rem; background: #f0f0f0; color: #555; border-radius: 4px; font-size: 0.75rem;">${skill.trim()}</span>`
                          ).join('')}
                          ${internship.skills.split(',').length > 3 ? `<span style="padding: 0.25rem 0.6rem; background: #f0f0f0; color: #555; border-radius: 4px; font-size: 0.75rem;">+${internship.skills.split(',').length - 3}</span>` : ''}
                      </div>

                      <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid #e2e8f0;">
                          <div style="display: flex; align-items: center; gap: 0.5rem;">
                              <span style="font-size: 0.9rem; font-weight: 600; color: #4a6fff;">${internship.applicationsReceived} Applications</span>
                          </div>

                          <div style="display: flex; gap: 0.5rem;" onclick="event.stopPropagation()">
                              <button onclick="togglePostStatus(${internship.id})" class="btn btn-sm btn-${internship.status === 'PUBLISHED' ? 'warning' : 'success'}" style="font-size: 0.75rem; padding: 0.4rem 0.7rem;">
                                  ${internship.status === 'PUBLISHED' ? 'Unpublish' : 'Publish'}
                              </button>
                              <button onclick="deleteInternship(${internship.id})" class="btn btn-sm btn-danger" style="font-size: 0.75rem; padding: 0.4rem 0.7rem;">Delete</button>
                          </div>
                      </div>

                      ${internship.postedDate ? `<div style="font-size: 0.75rem; color: #64748b; margin-top: 0.75rem; text-align: right;">Posted : ${internship.postedDate}</div>` : ''}
                  </div>
              `).join('')}
          </div>
      `;
  }

  function showPostPreview(postId) {
      const internship = dataManager.getInternships().find(i => i.id === postId);
      if (!internship) return;

      const previewHTML = `
          <div class="preview-container">
              <div class="preview-field"><div class="preview-label">Internship ID</div><div class="preview-value">${internship.internshipId}</div></div>
              <div class="preview-field"><div class="preview-label">Title</div><div class="preview-value"><strong>${internship.internshipTitle}</strong></div></div>
              <div class="preview-field"><div class="preview-label">Duration</div><div class="preview-value">${internship.duration}</div></div>
              <div class="preview-field"><div class="preview-label">Work Mode</div><div class="preview-value">${internship.workMode}</div></div>
              <div class="preview-field"><div class="preview-label">Required Skills</div><div class="preview-value">${internship.skills}</div></div>
              <div class="preview-field"><div class="preview-label">Status</div><div class="preview-value"><span class="badge badge-${internship.status === 'PUBLISHED' ? 'success' : 'warning'}">${internship.status}</span></div></div>
              <div class="preview-field"><div class="preview-label">Applications Received</div><div class="preview-value">${internship.applicationsReceived}</div></div>
              ${internship.postedDate ? `<div class="preview-field"><div class="preview-label">Posted Date</div><div class="preview-value">${internship.postedDate}</div></div>` : ''}
              <div class="preview-field"><div class="preview-label">Description</div><div class="preview-value">${internship.description}</div></div>
          </div>
      `;

      document.getElementById('previewContent').innerHTML = previewHTML;

      const footer = document.getElementById('previewModalFooter');
      if (footer) {
          footer.innerHTML = `
              <button class="btn btn-outline" onclick="closeModal('previewModal')">Close</button>
              <button class="btn btn-primary" onclick="closeModal('previewModal');editInternship(${postId})">‚úèÔ∏è Edit</button>
          `;
      }

      document.getElementById('previewModal').classList.add('active');
  }

  function toggleInternshipForm() {
      const modal = document.getElementById('internshipFormSheet');
      if (modal) {
          modal.classList.toggle('active');
          if (!modal.classList.contains('active')) {
              document.getElementById('internshipForm').reset();
              editingInternshipId = null;
              document.getElementById('internshipModalTitle').textContent = 'Create New Post';
          }
      }
  }

  function saveInternship(event) {
      if (event) event.preventDefault();

      const durationValue = document.getElementById('internshipDuration').value;
      const formData = {
          internshipId: document.getElementById('internshipCode').value,
          internshipTitle: document.getElementById('internshipTitle').value,
          duration: `${durationValue} Months`,
          workMode: document.getElementById('internshipWorkMode').value,
          skills: document.getElementById('internshipPrerequisites').value,
          description: document.getElementById('internshipDescription').value,
          status: document.getElementById('internshipStatus').value === 'Posted' ? 'PUBLISHED' : 'DRAFT'
      };

      if (!formData.internshipId || !formData.internshipTitle || !durationValue) {
          showStatusMessage('Please fill all required fields', 'error');
          return;
      }

      try {
          if (editingInternshipId) {
              dataManager.updateInternship(editingInternshipId, formData);
              showStatusMessage('Internship updated successfully', 'success');
          } else {
              const existing = dataManager.getInternships().find(i => i.internshipId === formData.internshipId);
              if (existing) {
                  showStatusMessage('Internship ID already exists', 'error');
                  return;
              }
              dataManager.addInternship(formData);
              showStatusMessage('Internship created successfully', 'success');
          }
          toggleInternshipForm();
          loadInternshipsData();
          updateDashboardStats();
      } catch (error) {
          console.error('Error saving internship:', error);
          showStatusMessage('Error saving internship', 'error');
      }
  }

  function editInternship(id) {
      const internship = dataManager.getInternships().find(i => i.id === id);
      if (internship) {
          editingInternshipId = id;
          document.getElementById('internshipCode').value = internship.internshipId;
          document.getElementById('internshipTitle').value = internship.internshipTitle;
          document.getElementById('internshipDuration').value = parseInt(internship.duration.split(' ')[0]) || '';
          document.getElementById('internshipWorkMode').value = internship.workMode;
          document.getElementById('internshipPrerequisites').value = internship.skills;
          document.getElementById('internshipDescription').value = internship.description;
          document.getElementById('internshipStatus').value = internship.status === 'PUBLISHED' ? 'Posted' : 'Draft';
          document.getElementById('internshipModalTitle').textContent = 'Edit Internship Post';
          document.getElementById('internshipFormSheet').classList.add('active');
      }
  }

  function togglePostStatus(id) {
      const internship = dataManager.getInternships().find(i => i.id === id);
      if (internship) {
          const newStatus = internship.status === 'DRAFT' ? 'PUBLISHED' : 'DRAFT';
          dataManager.updateInternship(id, { status: newStatus });
          loadInternshipsData();
          updateDashboardStats();
          showStatusMessage(`Internship ${newStatus.toLowerCase()} successfully`, 'success');
      }
  }

  function deleteInternship(id) {
      const internship = dataManager.getInternships().find(i => i.id === id);
      if (confirm(`Are you sure you want to delete "${internship.internshipTitle}"?`)) {
          dataManager.deleteInternship(id);
          loadInternshipsData();
          updateDashboardStats();
          showStatusMessage('Internship deleted successfully', 'success');
      }
  }

  function previewPost() {
      const code = document.getElementById('internshipCode').value;
      const title = document.getElementById('internshipTitle').value;
      const duration = document.getElementById('internshipDuration').value;
      const workMode = document.getElementById('internshipWorkMode').value;
      const skills = document.getElementById('internshipPrerequisites').value;
      const description = document.getElementById('internshipDescription').value;
      const status = document.getElementById('internshipStatus').value;

      const previewHTML = `
          <div class="preview-container">
              <div class="preview-field"><div class="preview-label">Internship ID</div><div class="preview-value">${code}</div></div>
              <div class="preview-field"><div class="preview-label">Title</div><div class="preview-value"><strong>${title}</strong></div></div>
              <div class="preview-field"><div class="preview-label">Duration</div><div class="preview-value">${duration} Months</div></div>
              <div class="preview-field"><div class="preview-label">Work Mode</div><div class="preview-value">${workMode}</div></div>
              <div class="preview-field"><div class="preview-label">Required Skills</div><div class="preview-value">${skills}</div></div>
              <div class="preview-field"><div class="preview-label">Status</div><div class="preview-value"><span class="badge badge-${status === 'Posted' ? 'success' : 'warning'}">${status}</span></div></div>
              <div class="preview-field"><div class="preview-label">Description</div><div class="preview-value">${description}</div></div>
          </div>
      `;
      document.getElementById('previewContent').innerHTML = previewHTML;

      const footer = document.getElementById('previewModalFooter');
      if (footer) {
          footer.innerHTML = `<button class="btn btn-outline" onclick="closeModal('previewModal')">Close</button>`;
      }

      document.getElementById('previewModal').classList.add('active');
  }

  function showSettingsTab(tabName) {
      document.querySelectorAll('.settings-content').forEach(content => content.classList.remove('active'));
      document.querySelectorAll('.settings-tab').forEach(tab => tab.classList.remove('active'));
      const targetContent = document.getElementById(tabName + 'Settings');
      if (targetContent) targetContent.classList.add('active');
      if (event && event.target) event.target.classList.add('active');
  }

  function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
          modal.classList.remove('active');
      }
  }

  function showStatusMessage(message, type = 'success') {
      let container = document.getElementById('statusMessageContainer');
      if (!container) {
          container = document.createElement('div');
          container.id = 'statusMessageContainer';
          container.style.cssText = 'position: fixed; top: 90px; right: 20px; z-index: 10000;';
          document.body.appendChild(container);
      }

      const messageDiv = document.createElement('div');
      messageDiv.className = `alert alert-${type === 'success' ? 'success' : 'error'}`;
      messageDiv.textContent = message;
      messageDiv.style.cssText = `padding: 12px 24px; margin-bottom: 10px; border-radius: 8px; font-weight: 500; box-shadow: 0 4px 12px rgba(0,0,0,0.15); animation: slideIn 0.3s ease;`;
      container.appendChild(messageDiv);
      setTimeout(() => {
          messageDiv.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => messageDiv.remove(), 300);
      }, 3000);
  }

  document.addEventListener('DOMContentLoaded', function() {
      console.log('üöÄ TrackerPro - Production Ready v7.0 - VIEW & EDIT WORKING');
      dataManager.initializeData();
      updateDashboardStats();
      loadRegistrationsData(1);
      loadUsersData('all');

      document.querySelectorAll('.nav-item').forEach(item => {
          item.addEventListener('click', function() {
              const pageId = this.getAttribute('data-page');
              if (pageId) showPage(pageId);
          });
      });

      window.onclick = function(event) {
          if (event.target.classList.contains('modal') || event.target.classList.contains('sheet')) {
              if (event.target.id === 'userSheet') {
                  closeUserSheet();
              } else {
                  event.target.classList.remove('active');
              }
          }
      };
  });

  const style = document.createElement('style');
  style.textContent = `
      @keyframes slideIn { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
      @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(400px); opacity: 0; } }
      .preview-container { padding: 1rem; }
      .preview-field { margin-bottom: 1rem; }
      .preview-label { font-weight: 600; color: #475569; margin-bottom: 0.25rem; font-size: 0.875rem; }
      .preview-value { color: #1e293b; line-height: 1.6; }

      .toggle-switch { position: relative; display: inline-block; width: 50px; height: 26px; }
      .toggle-switch input { opacity: 0; width: 0; height: 0; }
      .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .3s; border-radius: 26px; }
      .toggle-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .3s; border-radius: 50%; }
      .toggle-switch input:checked + .toggle-slider { background-color: #2ecc71; }
      .toggle-switch input:checked + .toggle-slider:before { transform: translateX(24px); }

      .sheet { display: none; position: fixed; top: 0; right: -100%; width: 500px; height: 100%; background: white; box-shadow: -4px 0 12px rgba(0,0,0,0.15); z-index: 9999; transition: right 0.3s ease; overflow-y: auto; }
      .sheet.active { display: block; right: 0; }
      .sheet-header { padding: 1.5rem; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; background: #f8f9fc; }
      .sheet-body { padding: 1.5rem; }
      .sheet-footer { padding: 1.5rem; border-top: 1px solid #e2e8f0; display: flex; justify-content: flex-end; gap: 0.75rem; position: sticky; bottom: 0; background: white; box-shadow: 0 -2px 8px rgba(0,0,0,0.05); }

      .filter-btn.active { background-color: var(--primary-color); color: white; }
  `;
  document.head.appendChild(style);
</script>
</body>
</html>